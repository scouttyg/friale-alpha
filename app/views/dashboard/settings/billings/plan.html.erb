<h1 class="flex items-center text-3xl font-extrabold dark:text-white mb-4 px-2">Settings</h1>
<div class="px-2">
  <div class="border-b border-gray-200 dark:border-gray-700">
    <%= render "shared/tabs/list",
    tabs: [
      { name: "Account Details", link: settings_account_url(current_account), active: false },
      { name: "Billing", link: overview_settings_billings_url(current_account), active: true },
      { name: "Members", link: settings_members_url(current_account), active: false },
    ]
    %>
  </div>
</div>
<section class="bg-gray-50 dark:bg-gray-900 py-3 sm:py-5">
  <div class="w-full bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">
    <%= render "shared/tabs/billing_tabs", current_account: current_account, active: :plan %>
    <div>
      <div class="mb-4 bg-white p-4 dark:bg-gray-800 sm:p-6">
        <div class="mb-4 flex items-center sm:mb-6">
          <a href="https://flowbite.com" class="me-3 flex items-center">
            <span class="self-center whitespace-nowrap text-2xl font-semibold dark:text-white">Data Later</span>
          </a>
          <% if @subscription&.plan_period %>
            <span class="me-2 rounded-sm bg-primary-100 px-2.5 py-0.5 text-sm font-medium text-primary-800 dark:bg-primary-900 dark:text-primary-300"><%= @subscription.plan_period.name %></span>
          <% else %>
            <span class="me-2 rounded-sm bg-primary-100 px-2.5 py-0.5 text-sm font-medium text-primary-800 dark:bg-primary-900 dark:text-primary-300">No Plan</span>
          <% end %>
        </div>

        <% if @subscription&.renewal_date %>
          <div class="mb-4 flex items-center justify-between border-b border-t border-gray-100 py-4 dark:border-gray-700 sm:mb-6">
            <time datetime="<%= @subscription.renewal_date.iso8601 %>" class="text-gray-500 dark:text-gray-400">Renewal Date: <%= @subscription.renewal_date.strftime("%D") %></time>
            <div class="text-xl font-semibold dark:text-white"><%= @subscription.plan_period.price.format %> / <%= @subscription.plan_period.interval %> </div>
          </div>
        <% end %>

        <% if @current_plan %>
          <div class="usage">
            <div class="members-limit">
              <div class="mb-2 flex justify-between text-base font-medium text-gray-900 dark:text-white">
                <span>Members</span>
                <span><%= current_account.members.size %> <span class="font-normal text-gray-500 dark:text-gray-400">of</span> <%= @current_plan.member_limit %> <span class="font-normal text-gray-500 dark:text-gray-400">active members</span></span>
              </div>
              <div class="mb-2 h-3 w-full rounded-sm bg-gray-200 dark:bg-gray-700">
                <div class="h-3 rounded-sm bg-primary-600" style="width: <%= (current_account.members.size/@current_plan.member_limit.to_f)*100 %>%"></div>
              </div>
            </div>
          </div>
          <h4 class="mb-4 text-xl font-bold text-gray-900 dark:text-white">Current plan benefits</h4>
          <div class="mb-4 space-y-3 sm:mb-6 sm:flex sm:space-x-24 sm:space-y-0 xl:block xl:space-x-0 xl:space-y-3 2xl:flex 2xl:space-x-24 2xl:space-y-0">
            <ul role="list" class="mb-8 space-y-4 text-left">
              <li class="flex items-center space-x-3">
                <svg class="flex-shrink-0 w-5 h-5 text-green-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg>
                <span>Member Limit: <span class="font-semibold"><%= @current_plan.member_limit %></span></span>
              </li>
            </ul>
          </div>
        <% end %>

        <div class="items-center space-y-4 sm:flex sm:space-x-4 sm:space-y-0">
          <% if @subscription %>
            <%= button_to cancel_settings_subscriptions_path(current_account),
                method: :delete,
                class: "w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:outline-none focus:ring-4 focus:ring-gray-100 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white dark:focus:ring-gray-700 sm:w-auto",
                data: { turbo_confirm: "Are you sure you want to cancel your subscription?" } do %>
              Cancel subscription
            <% end %>
          <% end %>
        </div>
      </div>
      <hr class="h-px my-8 bg-gray-200 border-0 dark:bg-gray-700">
      <div class="bg-white rounded-lg md:p-8 dark:bg-gray-800" id="about" role="tabpanel" aria-labelledby="about-tab">
        <section class="bg-white dark:bg-gray-900">
          <div class="mb-10 flex">
            <h2 class="whitespace-nowrap text-4xl font-semibold dark:text-white text-center ml-auto mr-auto">
            All Plans
            </h2>
          </div>
          <div class="px-4 mx-auto max-w-screen-xl lg:px-6 ">
            <div class="grid gap-8 mb-8 xl:grid-cols-3">
              <% @plans.each do |plan| %>
                <%= render "plan_pricing_card",
                    plan: plan,
                    path_for_new_subscription: new_settings_subscription_path(plan_id: plan.id) %>
              <% end %>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</section>